(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[166],{3310:function(e,t,a){Promise.resolve().then(a.bind(a,376))},376:function(e,t,a){"use strict";a.r(t);var s=a(7437),n=a(2265),l=a(1268),c=a(5217),i=a(3335),r=a(7648);t.default=()=>{let[e,t]=(0,n.useState)(!1),[a,d]=(0,n.useState)(!1),[o,m]=(0,n.useState)(null),[x,h]=(0,n.useState)(""),[u,f]=(0,n.useState)(""),[p,b]=(0,n.useState)(null),j=async()=>{try{t(!0);let e=await fetch("/api/categories",{method:"GET",cache:"no-store"});if(!e.ok)throw b(null),Error("".concat(e.status,": ").concat(e.statusText));let a=await e.json();b(a.map(e=>({id:e.id,name:e.name})))}catch(t){let e=t instanceof Error?"カテゴリの一覧のフェッチに失敗しました: ".concat(t.message):"予期せぬエラーが発生しました ".concat(t);console.error(e),m(e)}finally{t(!1)}};(0,n.useEffect)(()=>{j()},[]);let g=e=>e.length<2||e.length>16?"2文字以上16文字以内で入力してください。":p&&p.some(t=>t.name===e)?"同じ名前のカテゴリが既に存在します。":"",y=async e=>{e.preventDefault(),d(!0);try{let e=await fetch("/api/admin/categories",{method:"POST",cache:"no-store",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:x})});if(!e.ok)throw Error("".concat(e.status,": ").concat(e.statusText));h(""),await j()}catch(t){let e=t instanceof Error?"カテゴリのPOSTリクエストに失敗しました\n".concat(t.message):"予期せぬエラーが発生しました\n".concat(t);console.error(e),window.alert(e)}finally{d(!1)}};return e?(0,s.jsxs)("div",{className:"text-gray-500",children:[(0,s.jsx)(l.G,{icon:c.LM3,className:"mr-1 animate-spin"}),"Loading..."]}):p?(0,s.jsxs)("main",{children:[(0,s.jsx)("div",{className:"mb-4 text-2xl font-bold",children:"カテゴリの新規作成"}),a&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,s.jsxs)("div",{className:"flex items-center rounded-lg bg-white px-8 py-4 shadow-lg",children:[(0,s.jsx)(l.G,{icon:c.LM3,className:"mr-2 animate-spin text-gray-500"}),(0,s.jsx)("div",{className:"flex items-center text-gray-500",children:"処理中..."})]})}),(0,s.jsxs)("form",{onSubmit:y,className:(0,i.m6)("mb-4 space-y-4",a&&"opacity-50"),children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("label",{htmlFor:"name",className:"block font-bold",children:"名前"}),(0,s.jsx)("input",{type:"text",id:"name",name:"name",className:"w-full rounded-md border-2 px-2 py-1",placeholder:"新しいカテゴリの名前を記入してください",value:x,onChange:e=>{f(g(e.target.value)),h(e.target.value)},autoComplete:"off",required:!0}),u&&(0,s.jsxs)("div",{className:"flex items-center space-x-1 text-sm font-bold text-red-500",children:[(0,s.jsx)(l.G,{icon:c.ik8,className:"mr-0.5"}),(0,s.jsx)("div",{children:u})]})]}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{type:"submit",className:(0,i.m6)("rounded-md px-5 py-1 font-bold","bg-indigo-500 text-white hover:bg-indigo-600","disabled:cursor-not-allowed disabled:opacity-50"),disabled:a||""!==u||""===x,children:"カテゴリを作成"})})]}),(0,s.jsx)("div",{className:"mb-2 text-2xl font-bold",children:"作成されたカテゴリの一覧"}),0===p.length?(0,s.jsx)("div",{className:"text-gray-500",children:"（カテゴリは1個も作成されていません）"}):(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mb-2",children:"クリックすると各カテゴリの名前編集・削除画面に移動します。"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:p.map(e=>(0,s.jsx)("div",{className:(0,i.m6)("rounded-md px-2 py-0.5","border border-slate-400 text-slate-500"),children:(0,s.jsx)(r.default,{href:"/admin/categories/".concat(e.id),children:e.name})},e.id))})]})]}):(0,s.jsx)("div",{className:"text-red-500",children:o})}}},function(e){e.O(0,[676,268,335,648,971,117,744],function(){return e(e.s=3310)}),_N_E=e.O()}]);